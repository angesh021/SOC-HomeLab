# âœ… **03_eicar_malware_simulation.md**

### **Scenario 03 â€” EICAR Malware Simulation File Drop**

---

# ğŸ“ Overview

This scenario uses the harmless **EICAR malware test string** to ensure Wazuh + Sysmon correctly detect malware behavior.

---

# ğŸ¯ Objectives

* Detect file creation of EICAR
* Trigger AV detection (optional)
* Capture Sysmon Event 11
* Map to MITRE: **T1204 â€” User Execution**

---

# âš”ï¸ Attack Steps (Windows Victim)

### Create EICAR file:

```powershell
echo X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H* > C:\Users\Public\eicar.com
```

---

# ğŸ” Telemetry Collected

## **1. Sysmon â€“ File Creation**

Event ID **11** showing creation of suspicious file:

```
TargetFilename: C:\Users\Public\eicar.com
```

---

## **2. Windows Defender Alert**

If Defender is enabled:

```
Threat Detected: EICAR Test File
Action: Quarantined
```

---

## **3. Wazuh**

Search:

```
rule.description: "malware"
```

---

# ğŸ›¡ï¸ Wazuh Rule Example

(Optional â€“ for custom classification)

```xml
<rule id="300001" level="12">
  <field name="win.eventdata.TargetFilename">eicar.com</field>
  <description>EICAR Malware Test File Detected</description>
  <group>malware,file,execution</group>
</rule>
```

---

# ğŸ§  MITRE Mapping

**T1204 â€” User Execution**
**T1105 â€” Ingress Tool Transfer**

---

# ğŸ“Š Outcome

Confirms:

* File monitoring works
* AV logs flow to SIEM
* Malware classification pipeline

---
